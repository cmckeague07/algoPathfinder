<!DOCTYPE html>
<html>
<div class="nav">
	<input type="checkbox" id="nav-check">
	<div class="nav-header">
		<div class="nav-title">AlgoPathFinder</div>
	</div>
	<div class="nav-btn">
		<label for="nav-check"> <span></span> <span></span> <span></span>
		</label>
	</div>

	<div class="nav-links">
		<a href="/" target="_self">Depth First Search</a> 
		<a href="BFS.html" target="_self">Breadth First Search</a> 
		<a href="AStar.html" target="_self">A* Algorithm</a> 
		<a href="About.html" target="_self">About</a>
	</div>
</div>
<div class="nav" style="background-color: white; color: black;">
	<input type="checkbox" id="nav-check">
	<div class="nav-header">
		<div class="nav-title" style="font-size: 20px; color: black;">Start Node: &#x1F7E5;    Wall: &#x2B1B;    Path Node:  &#x1F7E8;    Destination: 
		<span style=" color: transparent; text-shadow: 0 0 0 rgb(0, 255, 255)">&#x1F7E5;</span></div>
	</div>
	<div class="nav-btn">
		<label for="nav-check"> <span></span> <span></span> <span></span>
		</label>
	</div>

	<div class="nav-links">
		<button style="float: left; display: inline; margin-top: 10px; margin-right: 10px;" name="findPath" id="findPath" form="myForm" type="submit" class="myButton">Visualize!</button> 
		<button style="float: left; display: inline; margin-top: 10px;" type="button" class="myButton" onClick="resetWall()">Reset</button>
	</div>
</div>
<head>
<meta charset="ISO-8859-1">



<link rel="stylesheet" href="../css/styless.css?version=6">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

</head>
<body>





	<form th:action="@{/findPathAStar}" method="post"  id="myForm" enctype="multipart/form-data">
		
		<div id="content" style="  margin: auto;   position: relative; text-align: center; top: 30%; width: 70%;">
		
			
			<h3 >A* Algorithm</h3>
			<p style="text-align:center;">A * algorithm is a searching algorithm that searches for the shortest path between the initial and the final state. 
			It is used in various applications, such as maps. 
			In maps the A* algorithm is used to calculate the shortest distance between the source (initial state) and the destination (final state).
			 
			 <div th:if="${message}" style="white-space: pre-line; display: inline-block; vertical-align: middle; 
										   height: 70px; font-size:24px; margin-top: -60px; margin-bottom: 30px;"
				th:class="${'alert ' + alertClass}">
				<h6 style="display: inline-block;" id="pathExists?" th:text="${message}"></h6>
			</div>
			</p>
				<div id="container" style=" display: inline-block;
						vertical-align: middle;" ></div>
					</div>
		
			
			
		
		 </form>


</body>

<script>/**
 * 
 */
 document.addEventListener("DOMContentLoaded", function(){
	createGrid();
	var startPoint = document.getElementById("node 0").style.backgroundColor= "red";
	findHighlightedPath();
	localStorage.clear();
	localStorage.setItem('wall ID50','50wall ID');
	localStorage.setItem('wall ID65','65wall ID');
	localStorage.setItem('wall ID133','133wall ID');
	localStorage.setItem('wall ID215','215wall ID');
	localStorage.setItem('wall ID9','9wall ID');
	localStorage.setItem('wall ID395','395wall ID');
	localStorage.setItem('wall ID29','29wall ID');
	localStorage.setItem('wall ID285','285wall ID');
	localStorage.setItem('wall ID184','2184wall ID');
	localStorage.setItem('wall ID90','90wall ID');
	localStorage.setItem('wall ID149','149wall ID');
	localStorage.setItem('wall ID320','320wall ID');
	localStorage.setItem('wall ID48','48wall ID');
	localStorage.setItem('wall ID63','63wall ID');
	localStorage.setItem('wall ID19','19wall ID');
	localStorage.setItem('wall ID249','249wall ID');
	localStorage.setItem('wall ID15','15wall ID');
	localStorage.setItem('wall ID338','338wall ID');
	localStorage.setItem('wall ID112','112wall ID');
	localStorage.setItem('wall ID325','325wall ID');
	localStorage.setItem('wall ID252','252wall ID');
	localStorage.setItem('wall ID35','35wall ID');
	localStorage.setItem('wall ID116','116wall ID');
	localStorage.setItem('wall ID360','360wall ID');
	localStorage.setItem('wall ID31','31wall ID');
	localStorage.setItem('wall ID157','157wall ID');
	localStorage.setItem('wall ID84','84wall ID');
	localStorage.setItem('wall ID13','13wall ID');
	localStorage.setItem('wall ID153','153wall ID');
	localStorage.setItem('wall ID79','79wall ID');
	localStorage.setItem('wall ID79','79wall ID');
	localStorage.setItem('wall ID380','380wall ID');
	localStorage.setItem('wall ID214','214wall ID');
	localStorage.setItem('wall ID261','261wall ID');
	localStorage.setItem('wall ID344','344wall ID');
	localStorage.setItem('wall ID36','36wall ID');
	localStorage.setItem('wall ID363','363wall ID');
	localStorage.setItem('wall ID209','209wall ID');
	localStorage.setItem('wall ID160','160wall ID');
	localStorage.setItem('wall ID383','383wall ID');
	localStorage.setItem('wall ID316','316wall ID');
	localStorage.setItem('wall ID253','253wall ID');
	localStorage.setItem('wall ID191','191wall ID');
	localStorage.setItem('wall ID152','152wall ID');
	localStorage.setItem('wall ID284','284wall ID');
	localStorage.setItem('wall ID180','180wall ID');
	localStorage.setItem('wall ID106','106wall ID');
	localStorage.setItem('wall ID34','34wall ID');
	localStorage.setItem('wall ID116','116wall ID');
	localStorage.setItem('wall ID188','188wall ID');
	localStorage.setItem('wall ID300','300wall ID');
	localStorage.setItem('wall ID290','290wall ID');
	localStorage.setItem('wall ID107','107wall ID');
	localStorage.setItem('wall ID159','159wall ID');
	localStorage.setItem('wall ID329','329wall ID');
	localStorage.setItem('wall ID74','74wall ID');
	localStorage.setItem('wall ID69','69wall ID');
	localStorage.setItem('wall ID146','146wall ID');
	localStorage.setItem('wall ID28','28wall ID');
	localStorage.setItem('wall ID167','167wall ID');
	localStorage.setItem('wall ID356','356wall ID');
	localStorage.setItem('wall ID362','362wall ID');
	localStorage.setItem('wall ID349','349wall ID');
	localStorage.setItem('wall ID390','390wall ID');
	localStorage.setItem('wall ID161','161wall ID');
	localStorage.setItem('wall ID161','162wall ID');
	localStorage.setItem('wall ID330','330wall ID');
	localStorage.setItem('wall ID227','227wall ID');
	localStorage.setItem('wall ID123','123wall ID');
	localStorage.setItem('wall ID70','70wall ID');
	localStorage.setItem('wall ID151','151wall ID');
	localStorage.setItem('wall ID62','62wall ID');
	localStorage.setItem('wall ID198','198wall ID');
	localStorage.setItem('wall ID331','331wall ID');
	localStorage.setItem('wall ID365','365wall ID');
	localStorage.setItem('wall ID199','199wall ID');
	localStorage.setItem('wall ID76','76wall ID');
	localStorage.setItem('wall ID108','108wall ID');
	localStorage.setItem('wall ID179','179wall ID');
	localStorage.setItem('wall ID165','165wall ID');
	localStorage.setItem('wall ID381','381wall ID');
	localStorage.setItem('wall ID216','216wall ID');
	localStorage.setItem('wall ID20','20wall ID');
	localStorage.setItem('wall ID189','189wall ID');
	localStorage.setItem('wall ID333','33wall ID');
	localStorage.setItem('wall ID196','196wall ID');
	localStorage.setItem('wall ID219','219wall ID');
	localStorage.setItem('wall ID306','306wall ID');
	localStorage.setItem('wall ID332','332wall ID');
	localStorage.setItem('wall ID64','64wall ID');
	localStorage.setItem('wall ID201','201wall ID');
	localStorage.setItem('wall ID139','139wall ID');
	localStorage.setItem('wall ID244','244wall ID');
	localStorage.setItem('wall ID370','370wall ID');
	localStorage.setItem('wall ID83','83wall ID');
	localStorage.setItem('wall ID173','173wall ID');
	localStorage.setItem('wall ID270','270wall ID');
	localStorage.setItem('wall ID283','283wall ID');
	localStorage.setItem('wall ID110','110wall ID');
	localStorage.setItem('wall ID337','337wall ID');
	localStorage.setItem('wall ID270','270wall ID');
	localStorage.setItem('wall ID283','283wall ID');
	localStorage.setItem('wall ID110','110wall ID');
	localStorage.setItem('wall ID337','337wall ID');
	localStorage.setItem('wall ID245','245wall ID');
	localStorage.setItem('wall ID156','156wall ID');
	localStorage.setItem('wall ID113','113wall ID');
	localStorage.setItem('wall ID53','53wall ID');
	localStorage.setItem('wall ID172','172wall ID');
	localStorage.setItem('wall ID388','388wall ID');
	localStorage.setItem('wall ID389','389wall ID');
	localStorage.setItem('wall ID369','369wall ID');
	localStorage.setItem('wall ID185','185wall ID');
	localStorage.setItem('wall ID75','75wall ID');
	localStorage.setItem('wall ID351','351wall ID');
	localStorage.setItem('wall ID350','350wall ID');
	localStorage.setItem('wall ID32','32wall ID');
	localStorage.setItem('wall ID385','385wall ID');
	localStorage.setItem('wall ID305','305wall ID');
	localStorage.setItem('wall ID366','366wall ID');
	addWall();
	
	
   
	
	
	
	function findHighlightedPath(){
		//Check once path is submitted, if a path exists
		
		if(document.getElementById("pathExists?") != null){
			    //Get our Path and manipulate into an array
			    
			  var pathExists = document.getElementById("pathExists?").innerHTML;
				
				pathExists = pathExists.replace("Path exists: [","");
				pathExists = pathExists.replace("]","");
				console.log("path exists early "  + pathExists);
			   
				var dest = pathExists.slice(-3);
				dest = dest.replace(",", "");
				dest = dest.trim();
				
				var temp = new Array();
				temp = pathExists.split(",").map(function(item) {
					  return item.trim();
				});
				console.log("temp: " + temp);
				//Tmeout function
				function sleep(ms) {
					  return new Promise(resolve => setTimeout(resolve, ms));
				}
				
				async function highlightPath() {
					  await sleep(500);
					  // Highlight the path square by square
				
					 for(var i = 0; i<=temp.length; i++){
							 await sleep(30);
							 var path = document.getElementById("node " + temp[i]);
							 if (!path) {
								    return; // don't do the rest
								  }
							 if(temp[i] != dest){
							 path.setAttribute("class", "node " + temp[i] + " path");
							 }else if(temp[i] == dest){
								 console.log("yes it does")
							 path.setAttribute("class", "node " + temp[i] + " final"); 
							 }
							 
						}
					 	
					}

					highlightPath(); }
			
		
	}
	
});




function addWall() {
	 //Using localStorage to store random generated wall
	if (Object.keys(localStorage).length === 0) {
 				console.log("There are no keys so we can create!!");
 				
 				for(var i = 1; i<125; i++){
 					var x = Math.floor((Math.random()*399)+1);
 					var wall = document.getElementById("node " + x).setAttribute("class", "node " + "W" + x );
 					localStorage.setItem("wall ID" + x,  x + "wall ID");
 					document.getElementById(x).setAttribute("value",  "W"+x);
 				}
			}else{
				console.log("Local Storage already exists so not creating new");
			}
			//If localStorage wall set, retain those walls on page refresh
			for (var x in localStorage) {
				   if(x!= null){
					   var x = x.substring(7);
					   var wall =  document.getElementById("node " + x);
					   var wall2 = document.getElementById(x);
					   if(!wall || !wall2){
						   return;
					   }

	 					document.getElementById("node "+x).style.pointerEvents = "none";
					   //add wall value to each node
					   wall.setAttribute("class", "node " + "W " + x );
					   var old = wall2.value;
					   wall2.value = "W" +old;
					   
				   }
				}
}

function resetWall(){
	localStorage.clear();
	localStorage.setItem('wall ID50','50wall ID');
	localStorage.setItem('wall ID65','65wall ID');
	localStorage.setItem('wall ID133','133wall ID');
	localStorage.setItem('wall ID215','215wall ID');
	localStorage.setItem('wall ID9','9wall ID');
	localStorage.setItem('wall ID395','395wall ID');
	localStorage.setItem('wall ID29','29wall ID');
	localStorage.setItem('wall ID285','285wall ID');
	localStorage.setItem('wall ID184','2184wall ID');
	localStorage.setItem('wall ID90','90wall ID');
	localStorage.setItem('wall ID149','149wall ID');
	localStorage.setItem('wall ID320','320wall ID');
	localStorage.setItem('wall ID48','48wall ID');
	localStorage.setItem('wall ID63','63wall ID');
	localStorage.setItem('wall ID19','19wall ID');
	localStorage.setItem('wall ID249','249wall ID');
	localStorage.setItem('wall ID15','15wall ID');
	localStorage.setItem('wall ID338','338wall ID');
	localStorage.setItem('wall ID112','112wall ID');
	localStorage.setItem('wall ID325','325wall ID');
	localStorage.setItem('wall ID252','252wall ID');
	localStorage.setItem('wall ID35','35wall ID');
	localStorage.setItem('wall ID116','116wall ID');
	localStorage.setItem('wall ID360','360wall ID');
	localStorage.setItem('wall ID31','31wall ID');
	localStorage.setItem('wall ID157','157wall ID');
	localStorage.setItem('wall ID84','84wall ID');
	localStorage.setItem('wall ID13','13wall ID');
	localStorage.setItem('wall ID153','153wall ID');
	localStorage.setItem('wall ID79','79wall ID');
	localStorage.setItem('wall ID79','79wall ID');
	localStorage.setItem('wall ID380','380wall ID');
	localStorage.setItem('wall ID214','214wall ID');
	localStorage.setItem('wall ID261','261wall ID');
	localStorage.setItem('wall ID344','344wall ID');
	localStorage.setItem('wall ID36','36wall ID');
	localStorage.setItem('wall ID363','363wall ID');
	localStorage.setItem('wall ID209','209wall ID');
	localStorage.setItem('wall ID160','160wall ID');
	localStorage.setItem('wall ID383','383wall ID');
	localStorage.setItem('wall ID316','316wall ID');
	localStorage.setItem('wall ID253','253wall ID');
	localStorage.setItem('wall ID191','191wall ID');
	localStorage.setItem('wall ID152','152wall ID');
	localStorage.setItem('wall ID284','284wall ID');
	localStorage.setItem('wall ID180','180wall ID');
	localStorage.setItem('wall ID106','106wall ID');
	localStorage.setItem('wall ID34','34wall ID');
	localStorage.setItem('wall ID116','116wall ID');
	localStorage.setItem('wall ID188','188wall ID');
	localStorage.setItem('wall ID300','300wall ID');
	localStorage.setItem('wall ID290','290wall ID');
	localStorage.setItem('wall ID107','107wall ID');
	localStorage.setItem('wall ID159','159wall ID');
	localStorage.setItem('wall ID329','329wall ID');
	localStorage.setItem('wall ID74','74wall ID');
	localStorage.setItem('wall ID69','69wall ID');
	localStorage.setItem('wall ID146','146wall ID');
	localStorage.setItem('wall ID28','28wall ID');
	localStorage.setItem('wall ID167','167wall ID');
	localStorage.setItem('wall ID356','356wall ID');
	localStorage.setItem('wall ID362','362wall ID');
	localStorage.setItem('wall ID349','349wall ID');
	localStorage.setItem('wall ID390','390wall ID');
	localStorage.setItem('wall ID161','161wall ID');
	localStorage.setItem('wall ID161','162wall ID');
	localStorage.setItem('wall ID330','330wall ID');
	localStorage.setItem('wall ID227','227wall ID');
	localStorage.setItem('wall ID123','123wall ID');
	localStorage.setItem('wall ID70','70wall ID');
	localStorage.setItem('wall ID151','151wall ID');
	localStorage.setItem('wall ID62','62wall ID');
	localStorage.setItem('wall ID198','198wall ID');
	localStorage.setItem('wall ID331','331wall ID');
	localStorage.setItem('wall ID365','365wall ID');
	localStorage.setItem('wall ID199','199wall ID');
	localStorage.setItem('wall ID76','76wall ID');
	localStorage.setItem('wall ID108','108wall ID');
	localStorage.setItem('wall ID179','179wall ID');
	localStorage.setItem('wall ID165','165wall ID');
	localStorage.setItem('wall ID381','381wall ID');
	localStorage.setItem('wall ID216','216wall ID');
	localStorage.setItem('wall ID20','20wall ID');
	localStorage.setItem('wall ID189','189wall ID');
	localStorage.setItem('wall ID333','33wall ID');
	localStorage.setItem('wall ID196','196wall ID');
	localStorage.setItem('wall ID219','219wall ID');
	localStorage.setItem('wall ID306','306wall ID');
	localStorage.setItem('wall ID332','332wall ID');
	localStorage.setItem('wall ID64','64wall ID');
	localStorage.setItem('wall ID201','201wall ID');
	localStorage.setItem('wall ID139','139wall ID');
	localStorage.setItem('wall ID244','244wall ID');
	localStorage.setItem('wall ID370','370wall ID');
	localStorage.setItem('wall ID83','83wall ID');
	localStorage.setItem('wall ID173','173wall ID');
	localStorage.setItem('wall ID270','270wall ID');
	localStorage.setItem('wall ID283','283wall ID');
	localStorage.setItem('wall ID110','110wall ID');
	localStorage.setItem('wall ID337','337wall ID');
	localStorage.setItem('wall ID270','270wall ID');
	localStorage.setItem('wall ID283','283wall ID');
	localStorage.setItem('wall ID110','110wall ID');
	localStorage.setItem('wall ID337','337wall ID');
	localStorage.setItem('wall ID245','245wall ID');
	localStorage.setItem('wall ID156','156wall ID');
	localStorage.setItem('wall ID113','113wall ID');
	localStorage.setItem('wall ID53','53wall ID');
	localStorage.setItem('wall ID172','172wall ID');
	localStorage.setItem('wall ID388','388wall ID');
	localStorage.setItem('wall ID389','389wall ID');
	localStorage.setItem('wall ID369','369wall ID');
	localStorage.setItem('wall ID185','185wall ID');
	localStorage.setItem('wall ID75','75wall ID');
	localStorage.setItem('wall ID351','351wall ID');
	localStorage.setItem('wall ID350','350wall ID');
	localStorage.setItem('wall ID32','32wall ID');
	localStorage.setItem('wall ID385','385wall ID');
	localStorage.setItem('wall ID305','305wall ID');
	localStorage.setItem('wall ID366','366wall ID');
	window.location.reload();
}

function createGrid(){
	let columns = 20;
	let space = '';
	let k=0;
	let y=19;
	let x=0;
	
	
	for(let i=0; i<columns; i++) {
		  space+= '<div class="row">'
		  for(let j=0; j<columns; j++){ 
			  space+= `<div class="node ${(k)}" id="node ${(k)}"> ${(k)}   <span style="display: none">x ${(x)}, y ${(y)} <span></div>`;
		      space+= `<input type="hidden" id="${(k)}" class="${(k)}" value= "${(k)} x ${(x)} y ${(y)} " name="payload">`;
		      k++;
		      x++;
		      if(x==20){
		    	  x=0;
		      }
		     
		      if(k>=0 && k<20){
		    	  y=19;
		      } else if(k>=20 && k<40){
		    	  y=18;
		      }else if(k>=40 && k<60){
		    	  y=17;
		      }else if(k>=60 && k<80){
		    	  y=16;
		      }else if(k>=80 && k<100){
		    	  y=15;
		      }else if(k>=100 && k<120){
		    	  y=14;
		      }else if(k>=120 && k<140){
		    	  y=13;
		      }else if(k>=140 && k<160){
		    	  y=12;
		      }else if(k>=160 && k<180){
		    	  y=11;
		      }else if(k>=180 && k<200){
		    	  y=10;
		      }else if(k>=200 && k<220){
		    	  y=9;
		      }else if(k>=220 && k<240){
		    	  y=8;
		      }else if(k>=240 && k<260){
		    	  y=7;
		      }else if(k>=260 && k<280){
		    	  y=6;
		      }else if(k>=280 && k<300){
		    	  y=5;
		      }else if(k>=300 && k<320){
		    	  y=4;
		      }else if(k>=320 && k<340){
		    	  y=3;
		      }else if(k>=340 && k<360){
		    	  y=2;
		      }else if(k>=360 && k<380){
		    	  y=1;
		      }else if(k>=380 && k<400){
		    	  y=0;
		      }
		      
		  };
		 
		  space+= '</div>'
		  
		}


		container.innerHTML = space;

		var addclass = 'destination';
		var $endPoint = $('.node').click(function(e) {
		    $endPoint.removeClass(addclass);
		    $(this).addClass(addclass);
		    
		    var x = document.getElementsByClassName("destination");
			var y =  x[0].innerHTML.trim();
			console.log(y);
			y = y.substring(0,3).trim();
			var nullcheck = document.getElementById("node " + y);
			document.getElementById(y).setAttribute("value", y + " destination");
			
			for(var x = 0; x<401; x++){
				 var nodes = document.getElementsByClassName("node " + x);
				    for (var i=0; i < nodes.length; i++) {
				    	//Filter all the nodes that are not the destination
				        if(nodes[i].className == "node "+x) {
				            // Reset back to original value
				           document.getElementById(x).setAttribute("value", x);
				        }
				    }
			  } 
		   
			 
			    
			
		});
		
}</script>

<style>

body {
    padding-bottom: 250px;
    height:100%;
}
.destination {
    background-color: #7FFFD4;
} 
.final{
	background-color: #7FFFD4;
}

.start {
	background-color: blue;
}

.path{
	background-color: yellow;
  	animation-name: example;
  	animation-duration: 2s;
}
@keyframes example {
  from {background-color: white;}
  to {background-color: yellow;}
}

.W{
	background-color: black;
	color: white;
	font-weight: normal;
}
.alert-danger{
	color: red;
}

.nav {
  height: 50px;
  width: 100%;
  background-color: #4d4d4d;
  position: relative;
}

.nav > .nav-header {
  display: inline;
}

.nav > .nav-header > .nav-title {
  display: inline-block;
  font-size: 22px;
  color: #fff;
  padding: 10px 10px 10px 10px;
}

.nav > .nav-btn {
  display: none;
}

.nav > .nav-links {
  display: inline;
  float: right;
  font-size: 18px;
}

.nav > .nav-links > a {
  display: inline-block;
  padding: 13px 10px 13px 10px;
  text-decoration: none;
  color: #efefef;
}

.nav > .nav-links > a:hover {
  background-color: rgba(0, 0, 0, 0.3);
}

.nav > #nav-check {
  display: none;
}

@media (max-width:600px) {
  .nav > .nav-btn {
    display: inline-block;
    position: absolute;
    right: 0px;
    top: 0px;
  }
  .nav > .nav-btn > label {
    display: inline-block;
    width: 50px;
    height: 50px;
    padding: 13px;
  }
  .nav > .nav-btn > label:hover,.nav  #nav-check:checked ~ .nav-btn > label {
    background-color: rgba(0, 0, 0, 0.3);
  }
  .nav > .nav-btn > label > span {
    display: block;
    width: 25px;
    height: 10px;
    border-top: 2px solid #eee;
  }
  .nav > .nav-links {
    position: absolute;
    display: block;
    width: 100%;
    background-color: #333;
    height: 0px;
    transition: all 0.3s ease-in;
    overflow-y: hidden;
    top: 50px;
    left: 0px;
  }
  .nav > .nav-links > a {
    display: block;
    width: 100%;
  }
  .nav > #nav-check:not(:checked) ~ .nav-links {
    height: 0px;
  }
  .nav > #nav-check:checked ~ .nav-links {
    height: calc(100vh - 50px);
    overflow-y: auto;
  }
}

.myButton {
	box-shadow: 0px 0px 0px 2px #041238;
	background-color:#ffffff;
	border-radius:1px;
	display:inline-block;
	cursor:pointer;
	color:#000000;
	font-family:Courier New;
	font-size:15px;
	font-style:italic;
	padding:3px 14px;
	text-decoration:none;
	margin-bottom: 30px;
	text-shadow:0px 1px 0px #000000;
}
.myButton:hover {
	background-color:#d9d7de;
}
.myButton:active {
	position:relative;
	top:1px;
}
</style>
</html>


